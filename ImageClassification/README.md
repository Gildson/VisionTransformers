I chose to use the Pillow library to process the image, but if you prefer, you can use OpenCV

I wrote an article that details the code in detail, it is available at the link below:

https://www.linkedin.com/pulse/transformers-computer-vision-gildson-santos-tuuqf/?trackingId=zLVRdREnRcym42PjKPfQ1A%3D%3D

It has some explanations in addition to the code and some links for those who want to go deeper.
